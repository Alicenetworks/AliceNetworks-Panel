import{k as vl,o as cl,Z as k,Y as l,W as t,r as d,V as f,X as v,U as _,N as n,a2 as M,j as u,a4 as S,_ as C,F as U,R as ye,a5 as fl,c as Se,L as ml,m as y}from"./vue-vendor-CGi32OHI.js";import{k as yl,l as gl,p as bl,m as xl,n as _l,o as Ue,q as wl,s as kl,t as hl,w as Cl,x as Tl,y as Sl,z as Ul,A as Nl,B as Pl,C as zl,D as Ml,E as Il,F as Al}from"./index-ZJAELyGg.js";import{E as Ne,T as Bl}from"./TableSkeleton-CpNcW2pL.js";import{u as ql}from"./useKeyboard-CbOLAjL8.js";import{u as Dl,f as Ll,g as m,e as h,B as c,b as Q,h as ge,i as A,j as H,k as Pe,l as Ol,m as $l,o as Gl,p as Hl}from"./naive-ui-B4L8VU6X.js";import{_ as Fl}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-3OKNQTir.js";import"./SwapHorizontalOutline-BSqMGymv.js";import"./ServerOutline-CH8la6EY.js";const jl={class:"nodes"},El={key:0,style:{"margin-bottom":"16px"}},Kl={style:{"margin-bottom":"16px"}},Rl={style:{"margin-bottom":"16px"}},Wl=vl({__name:"Nodes",setup(Vl){const i=Dl(),Z=Ll(),B=d(!1),ee=d(!1),q=d(!1),F=d([]),N=d(!1),le=d(!1),j=d(!1),ae=d(!1),E=d(!1),D=d("linux"),K=d(!1),te=d(null),se=d(""),V=d(""),X=d(""),w=d(null),L=d(""),oe=d(null),g=d([]),O=d({}),ne=d(!1),ue=d([]),b=d([]),R=d(""),be=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899","#06b6d4","#84cc16"],re=d([]),xe=d([]),$=d(null),P=d({page:1,pageSize:20,itemCount:0,showSizePicker:!0,pageSizes:[10,20,50,100]}),ze=[{label:"SOCKS5",value:"socks5"},{label:"HTTP/HTTPS",value:"http"},{label:"Shadowsocks",value:"ss"},{label:"Trojan",value:"trojan"},{label:"VMess",value:"vmess"},{label:"Relay (Port Forward)",value:"relay"},{label:"TCP Forward",value:"tcp"},{label:"UDP Forward",value:"udp"},{label:"SNI",value:"sni"},{label:"DNS",value:"dns"}],Me=[{label:"TCP",value:"tcp"},{label:"UDP",value:"udp"},{label:"TCP + UDP",value:"tcp+udp"},{label:"TLS",value:"tls"},{label:"mTLS",value:"mtls"},{label:"WebSocket (WS)",value:"ws"},{label:"WebSocket + TLS (WSS)",value:"wss"},{label:"HTTP/2 (H2)",value:"h2"},{label:"HTTP/2 Clear (H2C)",value:"h2c"},{label:"QUIC",value:"quic"},{label:"KCP",value:"kcp"},{label:"gRPC",value:"grpc"},{label:"PHT",value:"pht"},{label:"PHTS",value:"phts"}],Ie=[{label:"AES-256-GCM (Recommended)",value:"aes-256-gcm"},{label:"AES-128-GCM",value:"aes-128-gcm"},{label:"ChaCha20-IETF-Poly1305",value:"chacha20-ietf-poly1305"},{label:"XCHACHA20-IETF-Poly1305",value:"xchacha20-ietf-poly1305"},{label:"2022-BLAKE3-AES-256-GCM",value:"2022-blake3-aes-256-gcm"},{label:"2022-BLAKE3-CHACHA20-POLY1305",value:"2022-blake3-chacha20-poly1305"}],Y=()=>({name:"",host:"",port:38567,api_port:18080,api_user:"admin",api_pass:"",proxy_user:"",proxy_pass:"",protocol:"socks5",transport:"tcp",ss_method:"aes-256-gcm",ss_password:"",trojan_password:"",vmess_uuid:"",vmess_alter_id:0,tls_enabled:!1,tls_cert_file:"",tls_key_file:"",tls_sni:"",ws_path:"",ws_host:"",speed_limit:0,conn_rate_limit:0,dns_server:"",traffic_quota:0,quota_reset_day:1}),o=d(Y()),_e=Se({get:()=>o.value.traffic_quota/(1024*1024*1024),set:a=>{o.value.traffic_quota=Math.round(a*1024*1024*1024)}}),we=Se({get:()=>o.value.speed_limit/(1024*1024),set:a=>{o.value.speed_limit=Math.round(a*1024*1024)}}),de=a=>{if(a===0)return"0 B";const e=1024,r=["B","KB","MB","GB","TB"],T=Math.floor(Math.log(a)/Math.log(e));return parseFloat((a/Math.pow(e,T)).toFixed(2))+" "+r[T]},Ae=[{type:"selection",width:40},{title:"ID",key:"id",width:60},{title:"名称",key:"name"},{title:"地址",key:"host"},{title:"端口",key:"port",width:80},{title:"协议",key:"protocol",width:100,render:a=>y(h,{type:"info",size:"small"},()=>(a.protocol||"socks5").toUpperCase())},{title:"传输",key:"transport",width:80,render:a=>y(h,{size:"small"},()=>(a.transport||"tcp").toUpperCase())},{title:"状态",key:"status",width:80,render:a=>y(h,{type:a.status==="online"?"success":"default",size:"small"},()=>a.status==="online"?"在线":"离线")},{title:"延迟",key:"latency",width:80,render:a=>{const e=O.value[a.id];if(e===void 0)return y("span",{style:"color: #999; font-size: 12px"},"-");if(e===-1)return y(h,{type:"error",size:"small"},()=>"超时");const r=e<100?"success":e<300?"warning":"error";return y(h,{type:r,size:"small"},()=>`${e}ms`)}},{title:"流量",key:"traffic",width:160,render:a=>{if(a.traffic_quota>0){const e=Math.min(100,a.quota_used/a.traffic_quota*100);return y("div",{style:"min-width: 140px"},[y(Gl,{type:"line",percentage:e,status:a.quota_exceeded?"error":e>80?"warning":"success",showIndicator:!1,style:"margin-bottom: 4px"}),y("span",{style:"font-size: 11px; color: #666"},`${de(a.quota_used)} / ${de(a.traffic_quota)}`)])}return y("span",{style:"font-size: 12px"},de(a.traffic_in+a.traffic_out))}},{title:"操作",key:"actions",width:240,render:a=>{const e=[{label:"安装脚本",key:"install"},{label:"复制 URI",key:"copy"},{label:"同步配置",key:"sync"},{label:"查看配置",key:"config"},{label:"管理标签",key:"tags"},{label:"测试延迟",key:"ping"},{type:"divider",key:"d1"},{label:"删除",key:"delete"}],r=T=>{switch(T){case"install":Fe(a);break;case"copy":We(a);break;case"sync":Re(a);break;case"config":He(a);break;case"tags":al(a);break;case"ping":qe(a.id);break;case"delete":Ge(a);break}};return y(m,{size:"small"},()=>[y(c,{size:"small",onClick:()=>$e(a)},()=>"编辑"),y(Hl,{options:e,onSelect:r,trigger:"click"},()=>y(c,{size:"small"},()=>"更多"))])}}],z=async()=>{B.value=!0;try{const a=await yl({page:P.value.page,page_size:P.value.pageSize,search:L.value});F.value=a.items||[],P.value.itemCount=a.total||0}catch{i.error("加载节点失败")}finally{B.value=!1}},Be=async()=>{ne.value=!0;try{const a=await bl();O.value=a.results||{}}catch{i.error("延迟测试失败")}finally{ne.value=!1}},qe=async a=>{try{const e=await Pl(a);O.value={...O.value,[a]:e.latency}}catch{O.value={...O.value,[a]:-1}}},De=a=>{P.value.page=a,z()},Le=a=>{P.value.pageSize=a,P.value.page=1,z()},Oe=()=>{oe.value&&clearTimeout(oe.value),oe.value=setTimeout(()=>{P.value.page=1,z()},300)},ie=()=>{o.value=Y(),o.value.api_pass=G(16),w.value=null,N.value=!0},$e=a=>{w.value=a,o.value={...Y(),...a},N.value=!0},ke=async()=>{ee.value=!0;try{w.value?(await xl(w.value.id,o.value),i.success("节点已更新")):(await _l(o.value),i.success("节点已创建")),N.value=!1,z()}catch(a){i.error(a.response?.data?.error||"保存节点失败")}finally{ee.value=!1}},Ge=a=>{Z.warning({title:"删除节点",content:`确定要删除节点 "${a.name}" 吗？`,positiveText:"删除",negativeText:"取消",onPositiveClick:async()=>{try{await Nl(a.id),i.success("节点已删除"),z()}catch{i.error("删除节点失败")}}})},He=async a=>{try{const e=await Ml(a.id);se.value=typeof e=="string"?e:JSON.stringify(e,null,2),le.value=!0}catch{i.error("获取配置失败")}},Fe=async a=>{try{te.value=a.id,D.value="linux";const e=await Ue(a.id,"linux");V.value=e.script||"",X.value=e.one_line_command||"",ae.value=!0}catch{i.error("获取安装脚本失败")}},je=async a=>{if(te.value){K.value=!0;try{const e=await Ue(te.value,a);V.value=e.script||"",X.value=e.one_line_command||""}catch{i.error("获取安装脚本失败")}finally{K.value=!1}}},Ee=()=>{navigator.clipboard.writeText(X.value),i.success("一键命令已复制到剪贴板")},Ke=()=>{navigator.clipboard.writeText(V.value),i.success("已复制到剪贴板")},Re=async a=>{Z.warning({title:"同步配置到节点",content:`这将把当前配置推送到节点 "${a.name}"。该节点的 GOST 服务必须正在运行并启用了 API。`,positiveText:"同步",negativeText:"取消",onPositiveClick:async()=>{try{await Il(a.id),i.success("配置已成功同步到节点")}catch(e){i.error(e.response?.data?.error||"同步配置失败")}}})},We=async a=>{try{const e=await Al(a.id);navigator.clipboard.writeText(e.uri),i.success("代理 URI 已复制到剪贴板")}catch(e){i.error(e.response?.data?.error||"获取代理 URI 失败")}},Ve=()=>{navigator.clipboard.writeText(se.value),i.success("已复制到剪贴板")},Xe=async()=>{try{const[a,e]=await Promise.all([Tl(),Sl()]);re.value=a,xe.value=e}catch(a){console.error("Failed to load templates",a)}},Ye=()=>{$.value=null,re.value.length===0&&Xe(),j.value=!0},Je=a=>re.value.filter(e=>e.category===a),Qe=a=>({basic:"default",secure:"success",tunnel:"warning",advanced:"info"})[a]||"default",Ze=a=>{$.value=a},el=()=>{if(!$.value)return;const a=$.value,e=a.defaults;o.value={...Y(),protocol:e.protocol,transport:e.transport,port:e.port,tls_enabled:e.tls_enabled||!1,ws_path:e.ws_path||"",ss_method:e.ss_method||"aes-256-gcm"},e.require_auth&&(o.value.proxy_user="user"+Math.random().toString(36).substring(2,8),o.value.proxy_pass=G(16)),e.require_password&&(e.protocol==="ss"?o.value.ss_password=G(24):e.protocol==="trojan"&&(o.value.trojan_password=G(24))),e.require_uuid&&(o.value.vmess_uuid=ll()),o.value.api_pass=G(16),j.value=!1,N.value=!0,w.value=null,i.success(`模板 "${a.name}" 已应用。请填写其余字段。`)},G=a=>{const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let r="";for(let T=0;T<a;T++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},ll=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a=>{const e=Math.random()*16|0;return(a==="x"?e:e&3|8).toString(16)}),pe=async()=>{try{ue.value=await gl()}catch(a){console.error("Failed to load tags",a)}},al=async a=>{w.value=a;try{const e=await zl(a.id);b.value=e.map(r=>r.id)}catch{b.value=[]}E.value=!0},he=async()=>{if(R.value.trim())try{const a=be[Math.floor(Math.random()*be.length)];await wl({name:R.value.trim(),color:a}),R.value="",await pe(),i.success("标签创建成功")}catch(a){i.error(a.response?.data?.error||"创建标签失败")}},tl=async a=>{try{await Ul(a),await pe(),b.value=b.value.filter(e=>e!==a),i.success("标签已删除")}catch(e){i.error(e.response?.data?.error||"删除标签失败")}},sl=async()=>{if(w.value)try{await kl(w.value.id,b.value),E.value=!1,await z(),i.success("节点标签已更新")}catch(a){i.error(a.response?.data?.error||"更新标签失败")}},ol=a=>{g.value=a},nl=()=>{g.value.length!==0&&Z.warning({title:"批量删除确认",content:`确定要删除选中的 ${g.value.length} 个节点吗？此操作不可恢复！`,positiveText:"确定删除",negativeText:"取消",onPositiveClick:async()=>{q.value=!0;try{const a=await hl(g.value);i.success(a.message||`成功删除 ${a.success} 个节点`),g.value=[],await z()}catch(a){i.error(a.response?.data?.error||"批量删除失败")}finally{q.value=!1}}})},ul=async()=>{if(g.value.length!==0){q.value=!0;try{const a=await Cl(g.value);i.success(a.message||`成功同步 ${a.success} 个节点`),g.value=[]}catch(a){i.error(a.response?.data?.error||"批量同步失败")}finally{q.value=!1}}};return cl(()=>{z(),pe()}),ql({onNew:ie,modalVisible:N,onSave:ke}),(a,e)=>{const r=f("n-input"),T=f("n-data-table"),ve=f("n-card"),p=f("n-form-item"),I=f("n-input-number"),Ce=f("n-alert"),J=f("n-form"),ce=f("n-select"),rl=f("n-switch"),W=f("n-modal"),fe=f("n-code"),me=f("n-scrollbar"),dl=f("n-spin"),il=f("n-grid-item"),pl=f("n-grid");return v(),k("div",jl,[l(ve,null,{header:t(()=>[l(n(m),{justify:"space-between",align:"center"},{default:t(()=>[l(n(m),{align:"center"},{default:t(()=>[e[38]||(e[38]=M("span",null,"节点管理",-1)),g.value.length>0?(v(),_(n(h),{key:0,type:"info",size:"small"},{default:t(()=>[u(" 已选 "+S(g.value.length)+" 项 ",1)]),_:1})):C("",!0)]),_:1}),l(n(m),null,{default:t(()=>[g.value.length>0?(v(),k(U,{key:0},[l(n(c),{type:"warning",onClick:ul,loading:q.value},{default:t(()=>[...e[39]||(e[39]=[u(" 批量同步 ",-1)])]),_:1},8,["loading"]),l(n(c),{type:"error",onClick:nl,loading:q.value},{default:t(()=>[...e[40]||(e[40]=[u(" 批量删除 ",-1)])]),_:1},8,["loading"]),l(n(Q),{vertical:""})],64)):C("",!0),l(r,{value:L.value,"onUpdate:value":[e[0]||(e[0]=s=>L.value=s),Oe],placeholder:"搜索...",clearable:"",style:{width:"200px"}},null,8,["value"]),l(n(c),{loading:ne.value,onClick:Be},{default:t(()=>[...e[41]||(e[41]=[u(" 测试延迟 ",-1)])]),_:1},8,["loading"]),l(n(c),{onClick:Ye},{default:t(()=>[...e[42]||(e[42]=[u(" 快速配置 ",-1)])]),_:1}),l(n(c),{type:"primary",onClick:ie},{default:t(()=>[...e[43]||(e[43]=[u(" 添加节点 ",-1)])]),_:1})]),_:1})]),_:1})]),default:t(()=>[B.value&&F.value.length===0?(v(),_(Bl,{key:0,rows:5})):!B.value&&F.value.length===0&&!L.value?(v(),_(Ne,{key:1,type:"nodes","action-text":"添加节点",onAction:ie})):!B.value&&F.value.length===0&&L.value?(v(),_(Ne,{key:2,type:"search",description:`未找到与 '${L.value}' 匹配的节点`},null,8,["description"])):(v(),_(T,{key:3,columns:Ae,data:F.value,loading:B.value,"row-key":s=>s.id,pagination:P.value,"checked-row-keys":g.value,"onUpdate:checkedRowKeys":ol,remote:"","onUpdate:page":De,"onUpdate:pageSize":Le},null,8,["data","loading","row-key","pagination","checked-row-keys"]))]),_:1}),l(W,{show:N.value,"onUpdate:show":e[29]||(e[29]=s=>N.value=s),preset:"dialog",title:w.value?"编辑节点":"添加节点",style:{width:"700px"}},{action:t(()=>[l(n(m),null,{default:t(()=>[l(n(c),{onClick:e[28]||(e[28]=s=>N.value=!1)},{default:t(()=>[...e[53]||(e[53]=[u("取消",-1)])]),_:1}),l(n(c),{type:"primary",loading:ee.value,onClick:ke},{default:t(()=>[...e[54]||(e[54]=[u("保存",-1)])]),_:1},8,["loading"])]),_:1})]),default:t(()=>[l(n(ge),{type:"line",animated:""},{default:t(()=>[l(n(A),{name:"basic",tab:"基础"},{default:t(()=>[l(J,{model:o.value,"label-placement":"left","label-width":"120"},{default:t(()=>[l(p,{label:"名称"},{default:t(()=>[l(r,{value:o.value.name,"onUpdate:value":e[1]||(e[1]=s=>o.value.name=s),placeholder:"例如: HK-1"},null,8,["value"])]),_:1}),l(p,{label:"地址"},{default:t(()=>[l(r,{value:o.value.host,"onUpdate:value":e[2]||(e[2]=s=>o.value.host=s),placeholder:"例如: node.example.com"},null,8,["value"])]),_:1}),l(p,{label:"端口"},{default:t(()=>[l(I,{value:o.value.port,"onUpdate:value":e[3]||(e[3]=s=>o.value.port=s),min:1,max:65535,style:{width:"150px"}},null,8,["value"])]),_:1}),l(n(Q),{style:{margin:"12px 0"}},{default:t(()=>[l(n(H),{depth:"3",style:{"font-size":"12px"}},{default:t(()=>[...e[44]||(e[44]=[u("GOST API 配置（用于远程同步配置）",-1)])]),_:1})]),_:1}),l(p,{label:"API 端口"},{default:t(()=>[l(I,{value:o.value.api_port,"onUpdate:value":e[4]||(e[4]=s=>o.value.api_port=s),min:1,max:65535,style:{width:"150px"}},null,8,["value"])]),_:1}),l(p,{label:"API 用户"},{default:t(()=>[l(r,{value:o.value.api_user,"onUpdate:value":e[5]||(e[5]=s=>o.value.api_user=s),placeholder:"GOST WebAPI 用户名"},null,8,["value"])]),_:1}),l(p,{label:"API 密码"},{default:t(()=>[l(n(Pe),null,{default:t(()=>[l(r,{value:o.value.api_pass,"onUpdate:value":e[6]||(e[6]=s=>o.value.api_pass=s),type:"password",placeholder:"GOST WebAPI 密码","show-password-on":"click"},null,8,["value"]),l(n(c),{onClick:e[7]||(e[7]=s=>o.value.api_pass=G(16))},{default:t(()=>[...e[45]||(e[45]=[u("生成",-1)])]),_:1})]),_:1})]),_:1}),l(Ce,{type:"info",bordered:!1,style:{"font-size":"12px"}},{default:t(()=>[...e[46]||(e[46]=[u(" API 配置用于 Panel 直接调用 GOST 的 WebAPI 进行配置同步。如使用 Agent 模式，Agent 会自动配置。 ",-1)])]),_:1})]),_:1},8,["model"])]),_:1}),l(n(A),{name:"protocol",tab:"协议"},{default:t(()=>[l(J,{model:o.value,"label-placement":"left","label-width":"120"},{default:t(()=>[l(p,{label:"协议"},{default:t(()=>[l(ce,{value:o.value.protocol,"onUpdate:value":e[8]||(e[8]=s=>o.value.protocol=s),options:ze,style:{width:"200px"}},null,8,["value"])]),_:1}),l(p,{label:"传输层"},{default:t(()=>[l(ce,{value:o.value.transport,"onUpdate:value":e[9]||(e[9]=s=>o.value.transport=s),options:Me,style:{width:"200px"}},null,8,["value"])]),_:1}),["socks5","http"].includes(o.value.protocol)?(v(),k(U,{key:0},[l(p,{label:"代理用户"},{default:t(()=>[l(r,{value:o.value.proxy_user,"onUpdate:value":e[10]||(e[10]=s=>o.value.proxy_user=s),placeholder:"用户名"},null,8,["value"])]),_:1}),l(p,{label:"代理密码"},{default:t(()=>[l(r,{value:o.value.proxy_pass,"onUpdate:value":e[11]||(e[11]=s=>o.value.proxy_pass=s),type:"password",placeholder:"密码"},null,8,["value"])]),_:1})],64)):C("",!0),o.value.protocol==="ss"?(v(),k(U,{key:1},[l(p,{label:"加密方式"},{default:t(()=>[l(ce,{value:o.value.ss_method,"onUpdate:value":e[12]||(e[12]=s=>o.value.ss_method=s),options:Ie,style:{width:"250px"}},null,8,["value"])]),_:1}),l(p,{label:"SS 密码"},{default:t(()=>[l(r,{value:o.value.ss_password,"onUpdate:value":e[13]||(e[13]=s=>o.value.ss_password=s),type:"password",placeholder:"Shadowsocks 密码"},null,8,["value"])]),_:1})],64)):C("",!0),o.value.protocol==="trojan"?(v(),_(p,{key:2,label:"密码"},{default:t(()=>[l(r,{value:o.value.trojan_password,"onUpdate:value":e[14]||(e[14]=s=>o.value.trojan_password=s),type:"password",placeholder:"Trojan 密码"},null,8,["value"])]),_:1})):C("",!0),o.value.protocol==="vmess"?(v(),k(U,{key:3},[l(p,{label:"UUID"},{default:t(()=>[l(r,{value:o.value.vmess_uuid,"onUpdate:value":e[15]||(e[15]=s=>o.value.vmess_uuid=s),placeholder:"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"},null,8,["value"])]),_:1}),l(p,{label:"Alter ID"},{default:t(()=>[l(I,{value:o.value.vmess_alter_id,"onUpdate:value":e[16]||(e[16]=s=>o.value.vmess_alter_id=s),min:0,max:64},null,8,["value"])]),_:1})],64)):C("",!0)]),_:1},8,["model"])]),_:1}),l(n(A),{name:"transport",tab:"传输"},{default:t(()=>[l(J,{model:o.value,"label-placement":"left","label-width":"120"},{default:t(()=>[["tls","wss","h2","quic","grpc"].includes(o.value.transport)?(v(),k(U,{key:0},[l(p,{label:"启用 TLS"},{default:t(()=>[l(rl,{value:o.value.tls_enabled,"onUpdate:value":e[17]||(e[17]=s=>o.value.tls_enabled=s)},null,8,["value"])]),_:1}),l(p,{label:"证书文件"},{default:t(()=>[l(r,{value:o.value.tls_cert_file,"onUpdate:value":e[18]||(e[18]=s=>o.value.tls_cert_file=s),placeholder:"/path/to/cert.pem"},null,8,["value"])]),_:1}),l(p,{label:"密钥文件"},{default:t(()=>[l(r,{value:o.value.tls_key_file,"onUpdate:value":e[19]||(e[19]=s=>o.value.tls_key_file=s),placeholder:"/path/to/key.pem"},null,8,["value"])]),_:1}),l(p,{label:"SNI"},{default:t(()=>[l(r,{value:o.value.tls_sni,"onUpdate:value":e[20]||(e[20]=s=>o.value.tls_sni=s),placeholder:"服务器名称"},null,8,["value"])]),_:1})],64)):C("",!0),["ws","wss"].includes(o.value.transport)?(v(),k(U,{key:1},[l(p,{label:"WS 路径"},{default:t(()=>[l(r,{value:o.value.ws_path,"onUpdate:value":e[21]||(e[21]=s=>o.value.ws_path=s),placeholder:"/ws"},null,8,["value"])]),_:1}),l(p,{label:"WS Host"},{default:t(()=>[l(r,{value:o.value.ws_host,"onUpdate:value":e[22]||(e[22]=s=>o.value.ws_host=s),placeholder:"example.com"},null,8,["value"])]),_:1})],64)):C("",!0),l(n(Q),null,{default:t(()=>[...e[47]||(e[47]=[u("限速配置",-1)])]),_:1}),l(p,{label:"速度限制"},{default:t(()=>[l(n(m),null,{default:t(()=>[l(I,{value:we.value,"onUpdate:value":e[23]||(e[23]=s=>we.value=s),min:0,precision:2,style:{width:"150px"}},null,8,["value"]),e[48]||(e[48]=M("span",null,"MB/s (0 = 不限)",-1))]),_:1})]),_:1}),l(p,{label:"连接速率"},{default:t(()=>[l(n(m),null,{default:t(()=>[l(I,{value:o.value.conn_rate_limit,"onUpdate:value":e[24]||(e[24]=s=>o.value.conn_rate_limit=s),min:0,style:{width:"150px"}},null,8,["value"]),e[49]||(e[49]=M("span",null,"连接/秒 (0 = 不限)",-1))]),_:1})]),_:1}),l(n(Q),null,{default:t(()=>[...e[50]||(e[50]=[u("DNS 配置",-1)])]),_:1}),l(p,{label:"DNS 服务器"},{default:t(()=>[l(r,{value:o.value.dns_server,"onUpdate:value":e[25]||(e[25]=s=>o.value.dns_server=s),placeholder:"8.8.8.8:53 或 udp://1.1.1.1:53"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1}),l(n(A),{name:"quota",tab:"配额"},{default:t(()=>[l(J,{model:o.value,"label-placement":"left","label-width":"120"},{default:t(()=>[l(p,{label:"流量配额"},{default:t(()=>[l(n(m),null,{default:t(()=>[l(I,{value:_e.value,"onUpdate:value":e[26]||(e[26]=s=>_e.value=s),min:0,precision:2,style:{width:"150px"}},null,8,["value"]),e[51]||(e[51]=M("span",null,"GB (0 = 不限)",-1))]),_:1})]),_:1}),l(p,{label:"重置日"},{default:t(()=>[l(n(m),null,{default:t(()=>[l(I,{value:o.value.quota_reset_day,"onUpdate:value":e[27]||(e[27]=s=>o.value.quota_reset_day=s),min:1,max:28,style:{width:"100px"}},null,8,["value"]),e[52]||(e[52]=M("span",null,"每月第几天",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1},8,["show","title"]),l(W,{show:le.value,"onUpdate:show":e[30]||(e[30]=s=>le.value=s),preset:"dialog",title:"GOST 配置",style:{width:"700px","max-width":"90vw"}},{action:t(()=>[l(n(c),{onClick:Ve},{default:t(()=>[...e[55]||(e[55]=[u("复制",-1)])]),_:1})]),default:t(()=>[l(me,{"x-scrollable":"",style:{"max-height":"500px"}},{default:t(()=>[l(fe,{code:se.value,language:"yaml","word-wrap":""},null,8,["code"])]),_:1})]),_:1},8,["show"]),l(W,{show:ae.value,"onUpdate:show":e[32]||(e[32]=s=>ae.value=s),preset:"dialog",title:"节点安装脚本",style:{width:"750px","max-width":"90vw"}},{action:t(()=>[l(n(m),null,{default:t(()=>[l(n(c),{onClick:Ee,disabled:K.value},{default:t(()=>[...e[56]||(e[56]=[u("复制一键命令",-1)])]),_:1},8,["disabled"]),l(n(c),{onClick:Ke,disabled:K.value},{default:t(()=>[...e[57]||(e[57]=[u("复制完整脚本",-1)])]),_:1},8,["disabled"])]),_:1})]),default:t(()=>[l(n(ge),{value:D.value,"onUpdate:value":[e[31]||(e[31]=s=>D.value=s),je],type:"segment",style:{"margin-bottom":"16px"}},{default:t(()=>[l(n(A),{name:"linux",tab:"Linux / macOS"}),l(n(A),{name:"windows",tab:"Windows"})]),_:1},8,["value"]),l(dl,{show:K.value},{default:t(()=>[l(Ce,{type:"info",style:{"margin-bottom":"16px"}},{default:t(()=>[u(S(D.value==="linux"?"在目标服务器上运行以下命令：":"在 PowerShell (管理员) 中运行："),1)]),_:1}),l(ve,{size:"small",style:{"margin-bottom":"16px",overflow:"hidden"}},{default:t(()=>[l(me,{"x-scrollable":""},{default:t(()=>[l(fe,{code:X.value,language:D.value==="linux"?"bash":"powershell","word-wrap":""},null,8,["code","language"])]),_:1})]),_:1}),l(n(Ol),null,{default:t(()=>[l(n($l),{title:"查看完整脚本",name:"details"},{default:t(()=>[l(me,{"x-scrollable":"",style:{"max-height":"300px"}},{default:t(()=>[l(fe,{code:V.value,language:D.value==="linux"?"bash":"powershell","word-wrap":""},null,8,["code","language"])]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])]),_:1},8,["show"]),l(W,{show:j.value,"onUpdate:show":e[34]||(e[34]=s=>j.value=s),preset:"dialog",title:"快速配置 - 选择模板",style:{width:"800px"}},{action:t(()=>[l(n(m),null,{default:t(()=>[l(n(c),{onClick:e[33]||(e[33]=s=>j.value=!1)},{default:t(()=>[...e[59]||(e[59]=[u("取消",-1)])]),_:1}),l(n(c),{type:"primary",disabled:!$.value,onClick:el},{default:t(()=>[...e[60]||(e[60]=[u(" 使用此模板 ",-1)])]),_:1},8,["disabled"])]),_:1})]),default:t(()=>[l(n(ge),{type:"segment",animated:""},{default:t(()=>[(v(!0),k(U,null,ye(xe.value,s=>(v(),_(n(A),{key:s.id,name:s.id,tab:s.name},{default:t(()=>[l(pl,{"x-gap":12,"y-gap":12,cols:2},{default:t(()=>[(v(!0),k(U,null,ye(Je(s.id),x=>(v(),_(il,{key:x.id},{default:t(()=>[l(ve,{hoverable:"",class:ml({"template-selected":$.value?.id===x.id}),onClick:Te=>Ze(x),style:{cursor:"pointer"}},{header:t(()=>[l(n(m),{align:"center"},{default:t(()=>[l(n(h),{type:Qe(s.id),size:"small"},{default:t(()=>[u(S(x.defaults.protocol.toUpperCase()),1)]),_:2},1032,["type"]),M("span",null,S(x.name),1)]),_:2},1024)]),default:t(()=>[l(n(H),{depth:"3",style:{"font-size":"13px"}},{default:t(()=>[u(S(x.description),1)]),_:2},1024),l(n(m),{style:{"margin-top":"8px"}},{default:t(()=>[l(n(h),{size:"tiny"},{default:t(()=>[u(S(x.defaults.transport.toUpperCase()),1)]),_:2},1024),x.defaults.tls_enabled?(v(),_(n(h),{key:0,size:"tiny"},{default:t(()=>[...e[58]||(e[58]=[u("TLS",-1)])]),_:1})):C("",!0),l(n(h),{size:"tiny"},{default:t(()=>[u("Port: "+S(x.defaults.port),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class","onClick"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["name","tab"]))),128))]),_:1})]),_:1},8,["show"]),l(W,{show:E.value,"onUpdate:show":e[37]||(e[37]=s=>E.value=s),preset:"dialog",title:"管理节点标签",style:{width:"500px"}},{action:t(()=>[l(n(m),null,{default:t(()=>[l(n(c),{onClick:e[36]||(e[36]=s=>E.value=!1)},{default:t(()=>[...e[65]||(e[65]=[u("取消",-1)])]),_:1}),l(n(c),{type:"primary",onClick:sl},{default:t(()=>[...e[66]||(e[66]=[u("保存",-1)])]),_:1})]),_:1})]),default:t(()=>[w.value?(v(),k("div",El,[l(n(H),{depth:"3"},{default:t(()=>[u("节点: "+S(w.value.name),1)]),_:1})])):C("",!0),M("div",Kl,[l(n(H),{strong:"",style:{display:"block","margin-bottom":"8px"}},{default:t(()=>[...e[61]||(e[61]=[u("选择标签",-1)])]),_:1}),ue.value.length>0?(v(),_(n(m),{key:0},{default:t(()=>[(v(!0),k(U,null,ye(ue.value,s=>(v(),_(n(h),{key:s.id,color:{color:b.value.includes(s.id)?s.color:"transparent",textColor:b.value.includes(s.id)?"#fff":s.color,borderColor:s.color},bordered:!b.value.includes(s.id),checkable:"",checked:b.value.includes(s.id),"onUpdate:checked":x=>{x?b.value.push(s.id):b.value=b.value.filter(Te=>Te!==s.id)},closable:"",onClose:x=>tl(s.id),style:{cursor:"pointer"}},{default:t(()=>[u(S(s.name),1)]),_:2},1032,["color","bordered","checked","onUpdate:checked","onClose"]))),128))]),_:1})):(v(),_(n(H),{key:1,depth:"3"},{default:t(()=>[...e[62]||(e[62]=[u("暂无标签，请先创建",-1)])]),_:1}))]),M("div",Rl,[l(n(H),{strong:"",style:{display:"block","margin-bottom":"8px"}},{default:t(()=>[...e[63]||(e[63]=[u("创建新标签",-1)])]),_:1}),l(n(Pe),null,{default:t(()=>[l(r,{value:R.value,"onUpdate:value":e[35]||(e[35]=s=>R.value=s),placeholder:"输入标签名称",onKeyup:fl(he,["enter"])},null,8,["value"]),l(n(c),{type:"primary",onClick:he},{default:t(()=>[...e[64]||(e[64]=[u("创建",-1)])]),_:1})]),_:1})])]),_:1},8,["show"])])}}}),sa=Fl(Wl,[["__scopeId","data-v-6a7aca95"]]);export{sa as default};
