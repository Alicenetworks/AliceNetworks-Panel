import{k as B,o as N,Z as f,a2 as r,Y as o,W as t,c as V,V as a,X as u,N as P,j as m,U,a5 as K,a3 as M,r as c,a6 as $}from"./vue-vendor-CGi32OHI.js";import{b as j}from"./index-ZJAELyGg.js";import{u as q}from"./naive-ui-B4L8VU6X.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-3OKNQTir.js";const I={class:"reset-container"},S={key:0,class:"reset-content"},T={key:1,class:"reset-content"},W=B({__name:"ResetPassword",setup(X){const v=M(),C=$(),l=q(),d=c(!1),_=c(!1),s=c({password:"",confirmPassword:""}),i=V(()=>C.query.token),w=async()=>{if(!s.value.password){l.error("请输入新密码");return}if(s.value.password.length<6){l.error("密码至少6个字符");return}if(s.value.password!==s.value.confirmPassword){l.error("两次输入的密码不一致");return}d.value=!0;try{await j(i.value,s.value.password),_.value=!0}catch(b){l.error(b.response?.data?.error||"重置失败，链接可能已过期")}finally{d.value=!1}};return N(()=>{i.value}),(b,e)=>{const p=a("n-button"),y=a("n-result"),k=a("n-input"),g=a("n-form-item"),x=a("n-form"),R=a("n-card");return u(),f("div",I,[e[8]||(e[8]=r("div",{class:"bg-orb orb-1"},null,-1)),e[9]||(e[9]=r("div",{class:"bg-orb orb-2"},null,-1)),e[10]||(e[10]=r("div",{class:"bg-orb orb-3"},null,-1)),o(R,{class:"reset-card"},{default:t(()=>[e[7]||(e[7]=r("div",{class:"reset-header"},[r("h1",{class:"reset-title"},"重置密码"),r("p",{class:"reset-subtitle"},"请输入您的新密码")],-1)),i.value?_.value?(u(),f("div",T,[o(y,{status:"success",title:"密码已重置",description:"您的密码已成功重置，现在可以使用新密码登录了"},{footer:t(()=>[o(p,{type:"primary",onClick:e[1]||(e[1]=n=>P(v).push("/login"))},{default:t(()=>[...e[5]||(e[5]=[m("前往登录",-1)])]),_:1})]),_:1})])):(u(),U(x,{key:2,ref:"formRef",model:s.value},{default:t(()=>[o(g,{label:"新密码"},{default:t(()=>[o(k,{value:s.value.password,"onUpdate:value":e[2]||(e[2]=n=>s.value.password=n),type:"password",placeholder:"请输入新密码 (至少6个字符)","show-password-on":"click"},null,8,["value"])]),_:1}),o(g,{label:"确认密码"},{default:t(()=>[o(k,{value:s.value.confirmPassword,"onUpdate:value":e[3]||(e[3]=n=>s.value.confirmPassword=n),type:"password",placeholder:"再次输入新密码","show-password-on":"click",onKeyup:K(w,["enter"])},null,8,["value"])]),_:1}),o(p,{type:"primary",block:"",loading:d.value,onClick:w,class:"reset-btn"},{default:t(()=>[...e[6]||(e[6]=[m(" 重置密码 ",-1)])]),_:1},8,["loading"])]),_:1},8,["model"])):(u(),f("div",S,[o(y,{status:"error",title:"链接无效",description:"密码重置链接无效或缺少令牌"},{footer:t(()=>[o(p,{type:"primary",onClick:e[0]||(e[0]=n=>P(v).push("/forgot-password"))},{default:t(()=>[...e[4]||(e[4]=[m("重新获取",-1)])]),_:1})]),_:1})]))]),_:1})])}}}),F=E(W,[["__scopeId","data-v-edbab605"]]);export{F as default};
